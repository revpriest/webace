



TODO:
* EMAIL!
  * We are collecting email addresses, but I'm uncomfortable with
    actually showing them. We'll forward short text-only messages
    on for people I guess.
  * If you have an email linked account when you change your 
    email address then it DOES need to change or somehow reference
    back to the new email.
    * Cookies and Comments both have email and nick fields
    * If a sessions sets email when email is already set,
      it's a *change*, and we edit, what all the old cookies?
      all the old comments? Some kind of emails-that-have-been-used
      -and-are-so-equivalent table? 

* Right, how does the PM system work? Maybe knowing the
  answer to that will let me know what's wrong here 
  with the email address system.
  * Click a nick to see a profile page.
    * IFF the profile has a persistent ID, you can PM 'em.
    * Click "Send", type message, get thanks screen.
    * Next time that persistent-identity polls, we return
      the number of PMs they've got, and say "/view pms"
      to view 'em.
   * But why Private-message? Why have this backchanel?
     I want to be notified if people reply to me, but
     that's true of PUBLIC replies as well! What I really
     want, the reason I have a persistent ID, is just
     so I can turn on "Show replies to your comments"
     and have a new /mode:
     /mode page-and-replies-to-me
     /mode domain-and-replies-to-me
   * So it's the REPLIES system which is crucial, and
     you can either have "Send me a mail" when someone
     replies or "View 'em webace".

* Enable reset-email
* Hummm, the "Logout" button ought to be push, and
  require a paramter, and probably the revamped CSRF
  which I really must think deeply about tomorrow.
* Re-Enable CSRF!
* Redo CSRF for multiple-windows.
* Website needs comments by:
  * All By This-Nick
  * All By This-Email

* Add ability to set save state, with password protection
* Add auto-post-to-email
* Add auto-post-to-twitter
* Add auto-post-to-facebook
* Add avatar for those with certain nicks??
* Spam filters, inevitably, eventually.
* User-lists: view all stuff by this list of users
* View all stuff by top-rated?
  * Implies some rating stuff
* Clean up "commands" stuff, it needs a proper parser
  most likely, certainly at least each case calling a
  different function.





Blog Post Stuff:
 * Creating a new action with "zf create action" zapps all my out-of-function comments!
 * CSRF system won't allow two-window operation
   * May need to custom roll one
 * zend_db_Select for fetching rows
 * htmlpurifier
    * This is how we include it:
      $config = HTMLPurifier_Config::createDefault();
      $purifier = new HTMLPurifier($config);
      $config->set('HTML.Allowed', "a[href],b,i,strike,br,img[src|width|height]");
      $config->set('HTML.MaxImgLength' , 250);
      $config->set('CSS.MaxImgLength',"250px");
      $content = $purifier->purify( $content );
    * We allow links, CR etc, and images with max sizes.
      * Takes care of href=script attacks, images too
	large are removed in CSS, image-tag widths and
	heights are limited. 
  * Cross Origin Resource Sharing.
    When you launch webace from another domain, all the requests are send
    with Origin: headers, which we need to echo back with "Access-Control-Allow-Origin" headers
    There's a OPTIONS call before the POST call too.
    * Also need to add "WithCredentials" to the Ajax post.



